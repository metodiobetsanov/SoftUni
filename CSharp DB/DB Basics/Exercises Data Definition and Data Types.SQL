-- PROBLEM 1
CREATE DATABASE Minions

-- PROBLEM 2
CREATE TABLE Minions(
	ID INT NOT NULL,
	Name VARCHAR(50),
	Age INT,
	CONSTRAINT PK_Minions PRIMARY KEY (ID)
	)

CREATE TABLE Towns(
	ID INT NOT NULL,
	Name VARCHAR(50),
	CONSTRAINT PK_Towns PRIMARY KEY (ID)
	)

-- PROBLEM 3
ALTER TABLE Minions
ADD TownId INT CONSTRAINT FK_TOWNS FOREIGN KEY (TownID) REFERENCES Towns(ID)

-- PROBLEM 4
INSERT INTO Towns VALUES
(1,'Sofia'),
(2,'Plovdiv'),
(3,'Varna')

INSERT INTO Minions VALUES
(1,'Kevin', 22, 1),
(2, 'Bob', 15, 3),
(3,'Steward', NULL, 2)

-- PROBLEM 5
TRUNCATE TABLE Minions

-- PROBLEM 6
DROP TABLE Minions

DROP TABLE Towns

--PROBLEM 7
CREATE TABLE People(
	ID INT UNIQUE IDENTITY,
	Name VARCHAR(200) NOT NULL,
	Picture VARBINARY(MAX),
	Height DECIMAL(15, 2),
	Weight DECIMAL(15, 2),
	Gender VARCHAR(1) NOT NULL,
	Birthdate DATE NOT NULL,
	Biography VARCHAR(MAX),
	CONSTRAINT PK_People PRIMARY KEY (ID),
	CONSTRAINT CHECK_Gender CHECK (Gender = 'm' OR Gender = 'f'),
	CONSTRAINT CHECK_PictureSize CHECK (DATALENGTH(Picture) <= 2000000)
	)

INSERT INTO People VALUES
('GOSHO', NULL, NULL, NULL, 'm', '01-01-2001', NULL),
('PESHO', NULL, NULL, NULL, 'm', '01-01-2001', NULL),
('DANCHO', NULL, NULL, NULL, 'm', '01-01-2001', NULL),
('VANCHO', NULL, NULL, NULL, 'm', '01-01-2001', NULL),
('KOCE', NULL, NULL, NULL, 'm', '01-01-2001', NULL)

-- PROBLEM 8
CREATE TABLE Users(
	Id BIGINT UNIQUE IDENTITY NOT NULL,
	Username NVARCHAR(30) NOT NULL,
	Password VARCHAR(26) NOT NULL, 
	ProfilePicture VARBINARY,
	LastLoginTime DATE,
	IsDeleted BIT,
	CONSTRAINT PK_Users PRIMARY KEY (ID),
	CONSTRAINT CHECK_PictureSize CHECK (DATALENGTH(ProfilePicture)<900*1024)
)

INSERT INTO Users VALUES
('USER1', 'PASSWORD', NULL, NULL, 0),
('USER2', 'PASSWORD', NULL, NULL, 0),
('USER3', 'PASSWORD', NULL, NULL, 0),
('USER4', 'PASSWORD', NULL, NULL, 0),
('USER5', 'PASSWORD', NULL, NULL, 0)